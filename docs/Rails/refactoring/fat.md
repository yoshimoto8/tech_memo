# FatView, FatController, FatModel

Railsで単一の責任の原則などのオブジェクト思考の原則を無視して作っていくと、アプリケーションが大きくなるにつれて、モデルやコントローラ、ビューが肥大化し、一つのクラスやメソッドが管理できないほどの役割を持ってしったり、いろいろなコントローラで同じ処理を書いてしまっていたり、いつのまにかViewにロジックいっぱい書いてしまっていたり、といったことが往々にして起こります。そうなると、一つ一つのクラスの役割が大きくなり、変更どころか処理追うのも大変になるようなコードが生まれます。

Railsというフレームワークの上だからといってオブジェクト指向の基本は一緒です。SOLID原則をしっかりと守って設計していかないと後々変更の度に必ず苦労することになるし、テスタビリティが低いコードになってしまいます。テストを書くのが大変になって、これはなんのためにテストしてるんだろうみたいな事になりかねません。

Rails開発で初心者の方に知っておいてほしいのは、ビジネスロジックを追加するためのモデルはActiveRecordだけではないということです。ActiveRecordはActiveRecordパターンとORMの特徴を持つgemであり、永続的なデータと、それに対するロジックを追加するものです。このクラスがすべてのビジネスロジックを請け負うものではありません。モデル層は責務に応じて色々なクラスがあっていいはずです。

Railsには責務分割した上でも使いやすいようにモジュールとしてActiveModelが存在し、ValidatorやCallbackも他のクラスとして切り出せるようにな仕組みが用意されています。

ここでは具体的なクラス分割やアーキテクチャの話まではしませんが、いろいろな記事があるので参考にすると良いと思います。個人的に導入してよかったと思っているのは、以下はよかったなーと思っています。

```
UI層

view
view_object
アプリケーション層

controller
decorator
serializer
form
ドメイン層

model
finder
notifier
service
validator
callback
parameter

```
参考までに。

適切なクラス分割が出来ているコードは、変更するコストを下げることができます。取得系のロジックを変えたければfinderクラスを変えればいいですし、通知がメールからSlackになればnotifierクラスを変えればいいだけです。（技術的な関心ごとを直接書かない工夫は必要な場合はあります。それらはlibsにまとめるとか）気をつけて欲しいのは、意味が異なるのに同じような処理をしているからといって、同じクラスを使いまわしてしまうと、変更しづらいコードになってしまいます。

責務の分割はググってこうやるといいらしいで済ませるのは良くありません。本当にそのクラスがその知識を持つべきか、その振る舞いをするべきか、共通の振る舞いをする部分はないか、そこに抽象的なつながりはないかなどをチームとして考えることが大切だと思います。設計はアプリケーションの性質や規模、段階によって異なるため、一般的に使われてるから正しいとかそういったことはなく、どう分割するかを徹底的にチームで考えこみながら進めていくしかないと思います。抽象化したり、共通のロールを見つけたりと、設計はとても楽しいので、ぜひチームであーだこーだ言いながら話合うと良いと思います。

## 参照

https://qiita.com/shunhikita/items/7fdb5d95c883e38c63fc